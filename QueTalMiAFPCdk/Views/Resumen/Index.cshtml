@using QueTalMiAFPCdk.Models.Entities
@using QueTalMiAFPCdk.Models.Others
@using QueTalMiAFPCdk.Models.ViewModels
@using System.Globalization
@model ResumenViewModel
@{
    ViewData["Title"] = "Bienvenido a ¿Qué tal mi AFP?";
}

@section Head {
    <meta name="description" content="" />
}

@section Scripts {
    <script src="~/js/Resumen.js" asp-append-version="true"></script>
}

@{
    CultureInfo cultureInfo = new CultureInfo("es-CL");
}

<h1>@ViewData["Title"]</h1>

<p class="mt-3">
    
</p>

<hr />

<h5>Valores Cuota de la Semana</h5>

<form method="get">
    <div style="float: left;">
        <table class="table table-bordered" style="margin-top: 20px; margin-bottom: 1rem; table-layout:fixed; text-align:center; border:none; max-width:calc(120px + 1.5rem); width:calc(20vw + 1.5rem)">
            <tr style="height: calc(4.0rem + 1px);">
                <td style="text-align:center; max-width:calc(120px + 1.5rem); width:calc(20vw + 1.5rem); border-top:none; border-left:none;"></td>
            </tr>

            @foreach(ResumenAfp resumenAfp in Model.Resumenes)
            {
                <tr style="height:calc(min(80px, 15vw));">
                    <th class="align-middle p-0" style="text-align:center;">
                        <img class="rounded mx-auto d-block" style="max-width:120px; width: @(resumenAfp.Ancho)vw; height: calc(min(@(resumenAfp.Alto)vw, 55px));" src="@resumenAfp.UrlLogo" alt="AFP @resumenAfp.Nombre"/>
                    </th>
                </tr>
            }
        </table>
    </div>
    <div style="overflow: auto;">
        <table class="table table-bordered" style="margin-top: 20px; margin-bottom: 1rem; table-layout:fixed; width:100%; text-align:center; border:none;">
            <tr style="height: 4.0rem;">
                @foreach(DateTime fecha in Model.Fechas)
                {
                    <td style="width: 6rem; border-left:none;">
                        <p class="m-0 text-center text-muted text-truncate" style="font-size: 0.65rem;">@fecha.ToString("dddd").ToUpper()</p>
                        <p class="m-0 text-center text-muted">@fecha.ToString("d MMM")</p>
                    </td>
                }
            </tr>

            @foreach(ResumenAfp resumenAfp in Model.Resumenes)
            {
                <tr style="height:calc(min(80px, 15vw));">
                    @foreach(decimal? cuota in resumenAfp.ValoresCuota)
                    {
                        <td class="m-0 text-center text-muted align-middle" style="font-size: 0.80rem; border-left:none;">@(cuota != null ? cuota.GetValueOrDefault().ToString("N2", cultureInfo) : "")</td>
                    }
                </tr>
            }
        </table>
    </div>
</form>